---
title: ""
author: ""
date: "2023-03-19"
format:
  bookup-html:
    embed-fonts: false
toc: false
---

## Chapter 03: Discrete Random Variables


## Problem 3.1

**Let $X$ be a discrete random variable with probability mass function given by**

$$
p(x) = \begin{cases}
\frac{1}{4} &  x = 0 \\
\frac{1}{2} &  x = 1 \\
\frac{1}{8} &  x = 2 \\
\frac{1}{8} &  x = 3 \\
\end{cases}
$$

a. Verify that $p(x)$ is a probability mass function.
b. Find $P(X \geq 2)$.
c. Find $P(X \geq 2 | X \geq 1)$.
d. Find $P(X \geq 1 \cup X \geq 2)$.


### Part (a)

To be a valid probability function $p(x)$ must satisfy the following conditions:

- $p(x) \geq 0$ for all $x$.
- $\sum_{x} p(x) = 1$.

The first condition is satisfied by construction. The second condition is satisfied by the following calculation:

$$
\sum_{x} p(x) = \frac{1}{4} + \frac{1}{2} + \frac{1}{8} + \frac{1}{8} = 1
$$

### Part (b)

$$
P(X \geq 2) = P(X = 2) + P(X = 3)
$$

$$
P(X \geq 2) = \frac{1}{8} + \frac{1}{8} = \frac{1}{4}
$$

### Part(c)

We can use conditional probability as:

$$
P(X \geq 2 | X \geq 1) = \frac{P(X \geq 2 \cap X \geq 1)}{P(X \geq 1)}
$$

Since $X \geq 1$ is a subset of $X \geq 2$, we have that $P(X \geq 2 \cap X \geq 1) = P(X \geq 2)$.

$$
P(X \geq 2 | X \geq 1) = \frac{P(X \geq 2)}{P(X \geq 1)}
$$

$$
P(X \geq 2 | X \geq 1) = \frac{\frac{1}{4}}{\frac{3}{4}} = \frac{1}{3}
$$

### Part (d)

$$
P(X \geq 1 \cup X \geq 2) = P(X \geq 1) + P(X \geq 2) \\ - P(X \geq 1 \cap X \geq 2)
$$

Again, Since $X \geq 1$ is a subset of $X \geq 2$, we have that $P(X \geq 2 \cap X \geq 1) = P(X \geq 2)$.

$$
P(X \geq 1 \cap X \geq 2) = (X \geq 2)
$$

$$
P(X \geq 1 \cap X \geq 2) = \frac{1}{8} + \frac{1}{8} = \frac{1}{4}
$$

And finally:

$$
P(X \geq 1 \cup X \geq 2) = \frac{3}{4} + \frac{1}{4} - \frac{1}{4} = \frac{3}{4}
$$

Wich make sense, since $P(X \geq 1 \cup X \geq 2) = P(X \geq 1)$

## Problem 3.2

**Let $X$ be a discrete random variable with probability mass function given by**

$$
p(x) = \begin{cases}
\frac{1}{4} &  x = 0 \\
\frac{1}{2} &  x = 1 \\
\frac{1}{8} &  x = 2 \\
\frac{1}{8} &  x = 3 \\
\end{cases}
$$

a. Use `sample` to create a sample of size 10000 from $X$ and *estimate* $P(X = 1) from your sample. Your result should be close to 1/2.
b. Use `table` on your sample from part (a) to *estimate* the pmf of $X$ from your sample. Your result should be similar to the pmf given in the problem.


### Part (a)

```{r}
x <- sample(0:3, size = 10000, replace = TRUE, prob = c(1/4, 1/2, 1/8, 1/8))
mean(x == 1)
```

### Part (b)

```{r}
x <- sample(0:3, size = 10000, replace = TRUE, prob = c(1/4, 1/2, 1/8, 1/8))
table(x) / 10000
```

## Problem 3.3

**Let $X$ be a discrete random variable with probability mass function given by**

$$
p(x) = \begin{cases}
\frac{C}{4} &  x = 0 \\
\frac{C}{2} &  x = 1 \\
C           &  x = 2 \\
0           & \text{otherwise}
\end{cases}
$$

Find the value of $C$ that makes $p(x)$ is a probability mass function.

$$
\sum_{x} p(x) = \frac{C}{4} + \frac{C}{2} + C = 1
$$

$$
C = \frac{4}{7}
$$

## Problem 3.4

**Give an example of a probability mass function $p$ whose associated random variable has mean 0.**

By definition, the mean of a random variable is:

$$
\mu = \sum_{x} x p(x)
$$

We know the pmf is positive and the sum of all probabilities is 1, so we can choose any symetric random variable over the real numbers, with equal probabilities for both sides.

$$
p(x) = \begin{cases}
\frac{1}{4} &  x = -2 \\
\frac{1}{4} &  x = -1 \\
\frac{1}{4} &  x = 1 \\
\frac{1}{4} &  x = 2 \\
0           & \text{otherwise}
\end{cases}
$$

The mean is:

$$
\mu =  -2 \frac{1}{4} + -1 \frac{1}{4} + 1 \frac{1}{4} + 2 \frac{1}{4} = 0
$$

## Problem 3.5

**Find the mean of the random variable $X$ given in Exercise 3.1.**

$$
\mu = \sum_{x} x p(x) = 0 \frac{1}{4} + 1 \frac{1}{2} + 2 \frac{1}{8} + 3 \frac{1}{8} = \frac{9}{8}
$$

## Problem 3.6

Let $X$ be a random variable with pmf given by $p(x) = 1/10$ for $x = 1, \ldots, 10$ and $p(x) = 0$ for all other values of $x$. Find $E[X]$ and confirm your answer using simulation.

$$
E[x] = \sum_{x} x p(x) = 1 \frac{1}{10} + 2 \frac{1}{10} + \ldots + 10 \frac{1}{10} = 5.5
$$

```{r}
x <- sample(1:10, size = 10000, replace = TRUE, prob = rep(1/10, 10))
mean(x)
```

## Problem 3.7

**Suppose you roll two ordinary dice. Calculate the expected value of their product.**

First we need to find the pmf of the product of two dice:

| Product | Outcomes                       | Probability |
|---------|--------------------------------|-------------|
| 1       | (1, 1)                         | 1/36        |
| 2       | (1, 2), (2, 1)                 | 2/36        |
| 3       | (1, 3), (3, 1)                 | 2/36        |
| 4       | (1, 4), (4, 1), (2, 2)         | 3/36        |
| 5       | (1, 5), (5, 1)                 | 2/36        |
| 6       | (1, 6), (6, 1), (2, 3), (3, 2) | 4/36        |
| 8       | (2, 4), (4, 2)                 | 2/36        |
| 9       | (3, 3)                         | 1/36        |
| 10      | (2, 5), (5, 2)                 | 2/36        |
| 12      | (3, 4), (4, 3), (6, 2), (2, 6) | 4/36        |
| 15      | (3, 5), (5, 3)                 | 2/36        |
| 16      | (4, 4)                         | 1/36        |
| 18      | (6, 3), (3, 6)                 | 2/36        |
| 20      | (5, 4), (4, 5)                 | 2/36        |
| 24      | (6, 4), (4, 6)                 | 2/36        |
| 25      | (5, 5)                         | 1/36        |
| 30      | (6, 5), (5, 6)                 | 2/36        |
| 36      | (6, 6)                         | 1/36        |

And then we can calculate the expected value:

$$
E[x]  = 1 \frac{1}{36} + 2 \frac{2}{36} + \ldots + 36 \frac{1}{36} = 12.25
$$

We can also use simulation to confirm our answer:

```{r}
dice_1 <- sample(1:6, size = 10000, replace = TRUE)
dice_2 <- sample(1:6, size = 10000, replace = TRUE)
mean(dice_1 * dice_2)
```


## Problem 3.8

**Suppose that a hat contains slips of papers containing the numbers 1, 2, and 3. Two slips of paper are drawn without replacement. Calculate the expected value of the product of the numbers on the slips of paper.**

We need to find the pmf:

| Product | Outcomes       | Probability |
|---------|----------------|-------------|
| 2       | (2, 1), (1, 2) | 2/6         |
| 3       | (3, 1), (1, 3) | 2/6         |
| 6       | (3, 2), (2, 3) | 2/6         |

And then we can calculate the expected value:

$$
E[x]  = 2 \frac{2}{6} + 3 \frac{2}{6} + 6 \frac{2}{6} = \frac{22}{6}
$$

We can also use simulation to confirm our answer:

```{r}
event <- replicate(100000, {
  hat <- sample(1:3, size = 2, replace = FALSE)
  prod(hat)
})
mean(event)
```

## Problem 3.9

**Pick an integer from 0 to 999 with all possible numbers equally likely. What is the expected number of digits in your number?**

We need to find the pmf:

| Number of digits | Outcomes       | Probability |
|------------------|----------------|-------------|
| 1                | 0-9            | 10/1000     |
| 2                | 10-99          | 90/1000     |
| 3                | 100-999        | 900/1000    |

And then we can calculate the expected value:

$$
E[x] = 1 \frac{10}{1000} + 2 \frac{90}{1000} + 3 \frac{900}{1000} = 2.89
$$

We can also use simulation to confirm our answer:

```{r}
number <- sample(0:999, size = 100000, replace = TRUE)
mean(nchar(as.character(number)))
```

## Problem 3.10

**In the summer of 2020, the U.S. was considering pooled testing of COVID-19. This problem explores the math behind pooled testing. Since the availability of tests is limited, the testing center proposes the following pooled testing technique:**

* Two samples are randomly selected and combined. The combined sample is tested.
* If the combined sample tests negative, then both people are assumed negative.
* If the combined sample tests positive, then both people need to be retested for the disease.

Suppose in a certain population, 5% of the people being tested for COVID-19 actually have COVID-19. Let $X$ be the total number of tests that are run in order to test two randomly selected people.

a. What is the pmf of $X$?
b. What is the expected value of $X$?
c. Repeat the above, but imagine that three samples are combined, and let $Y$ be the total number of tests that are run in order to test three randomly selected people. If the pooled test is positive, then all three people need to be retested individually.
d. If your only concern is to minimize the expected number of tests given to the population, which technique would you recommend?

### Part (a)

To find the pmf of $X$, we need to determine the probability of each possible value of $X$:

First, consider the case where neither of the two individuals selected has COVID-19. The probability that the first individual selected does not have COVID-19 is 0.95, and the probability that the second individual selected does not have COVID-19, given that the first individual does not have COVID-19, is also 0.95. Therefore, the probability that neither individual has COVID-19 is:

$$
P = 0.95 \cdot 0.95 = 0.9025
$$

In this case, only one test is needed, since the combined sample will test negative and both individuals can be assumed negative. So, in this case, X = 1 with probability 0.9025.

Now, consider the case where one or both of the individuals selected has COVID-19. The probability that the first individual selected has COVID-19 is 0.05, and the probability that the second individual selected has COVID-19, given that the first individual does not have COVID-19, is also 0.05. Therefore, the probability that at least one individual has COVID-19 is:

$$
P = 1 - 0.9025 = 0.0975
$$

In this case, the combined sample will test positive, and both individuals will need to be retested. Since each individual will need to be tested once more, a total of three tests will be needed. So, in this case, X = 3 with probability 0.0975.

| X  | Probability   |
|----|---------------|
| 1  | 0.9025        |
| 3  | 0.0975        |

### Part (b)

$$
E[x] = 1 \cdot 0.9025 + 3 \cdot 0.0975 = 1.195
$$

### Part (c)

To find the pmf of $Y$, we need to determine the probability of each possible value of $Y$:

$$
P = 0.95 \cdot 0.95 \cdot 0.95 = 0.857375
$$

In this case, only one test is needed, since the combined sample will test negative and all three individuals can be assumed negative. So, in this case, Y = 1 with probability 0.857375.

Now consider the case where one or more of the individuals selected has COVID-19. The probability that at least one individual has COVID-19 is:

$$
P = 1 - 0.857375 = 0.142625
$$

In this case, the combined sample will test positive, and all three individuals will need to be retested. Since each individual will need to be tested once more, a total of four tests will be needed. So, in this case, Y = 4 with probability 0.142625.

| Y  | Probability   |
|----|---------------|
| 1  | 0.857375      |
| 4  | 0.142625      |

And the expected value of $Y$ is:

$$
E[y] = 1 \cdot 0.857375 + 4 \cdot 0.142625 = 1.442
$$

### Part (d)

Since the expected value of $X$ is 1.195 and the expected value of $Y$ is 1.442, we would recommend the technique that minimizes the expected number of tests, which is the technique that tests two samples at a time.


## Problem 3.11

**A roulette wheel has 38 slots and a ball that rolls until it falls into one of the slots, all of which are equally likely. Eighteen slots are black numbers, eighteen are red numbers, and two are green zeros. If you bet on "red" and the ball lands in a red slot, the casino pays you your bet; otherwise, the casino wins your bet.**

a. What is the expected value of a \$1 bet on red?
b. Suppose you bet \$1 on red, and if you win you “let it ride” and bet $2 on red. What is the expected value of this plan?

### Part (a)

We need to find the probability of winning, which is the probability that the ball lands in a red slot. There are 18 red slots, so the probability of winning is:

$$
P = \frac{18}{38} = 0.4736
$$

The pmf of the random variable $X$ is:

| X   | Probability   |
|-----|---------------|
| -1  | 0.5263        |
|  1  | 0.4736        |

And the expected value of $X$ is:

$$
E[x] = -1 \cdot 0.5263 + 1 \cdot 0.4736 = -0.0527
$$

### Part (b)

Under this betting plan, there are three possible outcomes:

1. The ball lands on black or green on the first spin, and you lose \$1.
2. The ball lands on red on the first spin, and you win $1. Then, the ball lands on black or green on the second spin, and you lose \$2.
3. The ball lands on red on both spins, and you win $1 on the first spin and \$2 on the second spin.

The probability of each of these outcomes can be calculated as follows:

1. Probability of losing on the first spin: $\frac{20}{38} = 0.5263$
2. Probability of winning on the first spin and losing on the second spin $\frac{18}{38} \cdot \frac{20}{38} = 0.2493$
3. Probability of winning on both spins $\frac{18}{38} \cdot \frac{18}{38} = 0.2243$

$$
P = \frac{18}{38} \cdot \frac{18}{38} = 0.2243
$$

The pmf of the random variable $X$ is:

| X   | Probability   |
|-----|---------------|
| -2  | 0.2493        |
| -1  | 0.5263        |
|  3  | 0.2243        |

And the expected value of $X$ is:

$$
E[x] = -2 \cdot 0.2493 - 1 \cdot 0.5263 + 3 \cdot 0.2243 = -0.352
$$
