{
  "hash": "dbc752bfd8e485230d89eb916f011186",
  "result": {
    "markdown": "---\ntitle: \"\"\nauthor: \"\"\ndate: today\nformat:\n  bookup-html:\n    embed-fonts: false\ntoc: true\n---\n\n\n## Chapter 02: Probability\n\n### Problem 2.1\n\n**When rolling two dice, what is the probability that one die is twice the other?**\n\nSuppose  we have a red die and a green die. The event that one of them shows twice what the other shows is the union of\n\na. the red die shows twice the number of what the green shows.\nb. the green die shows twice the number of what the red shows.\n\nIf sides are numbererd starting with 1. These two event are mutually exclusive.\nSo the probability of the event is the sum of the probabilities of the two events.\n\n$$\nP(A \\cup B) = P(A) + P(B) = \\frac{1}{2} \\cdot \\frac{1}{6} + \\frac{1}{2} \\cdot \\frac{1}{6} = \\frac{1}{6}\n$$\n\nwe can simulate this experiment in R as follow:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent <- replicate(100000, {\n    die_1 <- sample(x = 1:6, size = 1, replace = TRUE)\n    die_2 <- sample(x = 1:6, size = 1, replace = TRUE)\n    (die_1 == 2 * die_2) | (die_2 == 2 * die_1)\n})\nmean(event)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.16606\n```\n:::\n:::\n\n\n### Problem 2.2\n\n**Consider an experiment where you roll two dice, and subtract the smaller value from the larger value (getting 0 in case of a tie).**\n\na. What is the probability of getting 0?\nb. What is the probability of getting 4?\n\n#### Part (a)\n\nThe probability of getting 0 is the probability of getting a tie. This is the probability of getting the same number on both dice. \n\n$$\nE = \\{(1,1), (2,2), (3,3), (4,4), (5,5), (6,6) \\}\n$$ \n\nand we have $6 \\cdot 6 = 36$ possible outcomes. So: \n\n$$\nP(E) = \\frac{6}{36} = \\frac{1}{6}\n$$\n\nwe can simulate this experiment in R as follow:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent <- replicate(100000, {\n    die_1 <- sample(x = 1:6, size = 1, replace = TRUE)\n    die_2 <- sample(x = 1:6, size = 1, replace = TRUE)\n    die_1 == die_2\n})\nmean(event)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1669\n```\n:::\n:::\n\n\n#### Part (b)\n\nThe probability of getting 4 is the probability of getting a difference of 4.\n\n $$\n E = \\{(1,5), (5,1), (2,6), (6,2) \\}\n $$\n\nand we have $6 \\cdot 6 = 36$ possible outcomes. So:\n\n$$\nP(E) = \\frac{4}{36} = \\frac{1}{9}\n$$\n\nwe can simulate this experiment in R as follow:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent <- replicate(100000, {\n    die_1 <- sample(x = 1:6, size = 1, replace = TRUE)\n    die_2 <- sample(x = 1:6, size = 1, replace = TRUE)\n    abs(die_1 - die_2) == 4\n})\nmean(event)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.11113\n```\n:::\n:::\n\n\n### Problem 2.3\n\n**A hat contains slips of paper numbered 1 through 6. You draw two slips of paper at random from the hat, without replacing the first slip into the hat.**\n\na. Write out the sample space $S$ for this experiment.\nb. Write out the event $E$ \"the sum of the numbers on the slips of paper is 4\".\nc. Find $P(E)$.\nd. Let $F$ be the event \"the larger number minus the smaller number is 0\". What is $P(F)$?\n\n#### Part (a) \n\nWe can write the sample space as: \n\n$$\nS = \\{(1,2), (1,3), (1,4), (1,5), (1,6), (2,1), (2,3), (2,4), (2,5), (2,6), \\cdots , (6,5) \\}\n$$\n\n#### Part (b)\n\nWe can write the event as:\n\n$$\nE = \\{(1,3), (3,1) \\}\n$$\n\n#### Part (c)\n\nWe have $6 \\cdot 5 = 30$ possible outcomes. So:\n\n$$\nP(E) = \\frac{2}{30} = \\frac{1}{15}\n$$ \n\nwe can simulate it in R as follows:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent <- replicate(100000, {\n    hat <- sample(x = 1:6, size = 2, replace = FALSE)\n    sum(hat) == 4\n})\nmean(event)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.06649\n```\n:::\n:::\n\n\n#### Part (d)\n\nSince we cannot draw the same number twice:\n\n$$\nF = \\emptyset\n$$\n\n$$\nP(F) = 0\n$$\n\n### Problem 2.4\n\n**Suppose there are two boxes and each contain slips of papers numbered 1-8. You draw one number at random from each box.**\n\na. Estimate the probability that the sum of the numbers is 8.\nb. Estimate the probability that at least one of the numbers is a 2.\n\n#### Part (a)\n\nThere are $8 \\cdot 8 = 64$ possible outcomes. The number of outcomes where the sum is 8 is:\n\n$$ \nE = \\{(1,7), (2,6), (3,5), (4,4), (5,3), (6,2), (7,1) \\}\n$$ \nand the probability is:\n\n$$\nP(E) = \\frac{7}{64}\n$$\n\nWe can simulate this experiment in R as follows:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent <- replicate(100000, {\n    box_1 <- sample(x = 1:8, size = 1, replace = TRUE)\n    box_2 <- sample(x = 1:8, size = 1, replace = TRUE)\n    sum(box_1 + box_2) == 8\n})\nmean(event)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.10966\n```\n:::\n:::\n\n\n#### Part (b)\n\nSimilarly, the number of outcomes where at least one of the numbers is 2 is:\n\n$$\nE = \\{(1,2), (2,1), (2,2), (2,3), \\cdots, (8,2) \\}\n$$ \n\nand the probability is: \n\n$$\nP(E) = \\frac{15}{64}\n$$\n\nWe can simulate this experiment in R as follows:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent <- replicate(100000, {\n    box_1 <- sample(x = 1:8, size = 1, replace = TRUE)\n    box_2 <- sample(x = 1:8, size = 1, replace = TRUE)\n    box_1 == 2 | box_2 == 2\n})\nmean(event)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.23318\n```\n:::\n:::\n\n\n### Problem 2.5\n\n**Suppose the proportion of M&M’s by color is:** \n\n| Yellow | Red  | Orange | Brown | Green | Blue |\n|--------|------|--------|-------|-------|------|\n| 0.14   | 0.13 | 0.20   | 0.12  | 0.20  | 0.21 |\n\na. What is the probability that a randomly selected M&M is not green?\nb. What is the probability that a randomly selected M&M is red, orange, or yellow?\nc. Estimate the probability that a random selection of four M&M’s will contain a blue one.\nd. Estimate the probability that a random selection of six M&M’s will contain all six colors.\n\n\n#### Part (a)\n\nUsing the law of complement, we have:\n\n$$\nP(\\neg \\text{green}) = 1 - P(\\text{green}) = 0.80\n$$\n\n#### Part (b)\n\nWe can use the law of addition to find the probability of getting red, orange, or yellow:\n\n$$\nP(\\text{red} \\cup \\text{orange} \\cup \\text{yellow}) = P(\\text{red}) + P(\\text{orange}) + P(\\text{yellow}) = 0.13 + 0.20 + 0.14 = 0.47\n$$\n\n#### Part (c)\n\nBy the law of complement the probability of not getting a blue is $P(\\neg \\text{blue}) = 1 - 0.21 = 0.79$ and the probability of not getting a blue in four selections is $P(\\neg \\text{blue in four selections}) = (0.79)^4 = 0.39$. Then the probability of getting at least one blue in four selections is:\n\n$$\nP(\\text{at least one blue}) = 1 - P(\\neg \\text{blue in four selection}) = 1 - 0.39 = 0.61\n$$\n\nWe can simulate this experiment in R as follows:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent <- replicate(100000, {\n    mms <- sample(x = c(\"yellow\", \"red\", \"orange\", \"brown\", \"green\", \"blue\"),\n     size = 4, p = c(0.14, 0.13, 0.20, 0.12, 0.20, 0.21), replace = TRUE)\n    \"blue\" %in% mms\n})\nmean(event)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6089\n```\n:::\n:::\n\n\n#### Part (d)\n\nThe probability of selecting six M&M's that contain all six colors is (consdiering ordering):\n\n$$\nP(\\text{all colors ordered}) = (0.14)(0.13)(0.20)(0.12)(0.20)(0.21) = 0.0000183456\n$$\n\nwe need to calculate the total number of ways we can select six M&M's from a total of 6 colors, with a sample size of 6.\nThat is $6!$. Then the probability is:\n\n$$\nP(\\text{all six colors}) = 6! \\cdot  P(\\text{all colors ordered}) = 0.0132\n$$\n\nWe can simulate this experiment in R as follows:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent <- replicate(100000, {\n    mms <- sample(x = c(\"yellow\", \"red\", \"orange\", \"brown\", \"green\", \"blue\"),\n     size = 6, p = c(0.14, 0.13, 0.20, 0.12, 0.20, 0.21), replace = TRUE)\n    length(unique(mms)) == 6\n})\nmean(event)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.01317\n```\n:::\n:::\n\n\n### Problem 2.6\n\n**With the distribution from Problem 2.5, suppose you buy a bag of M&M’s with 30 pieces in it.\nEstimate the probability of obtaining at least 9 Blue M&M’s and at least 6 Orange M&M’s in the bag.**\n\n::: {.callout-warning}\nSince I'm not quite sure on how to calculate this without the binomial distribution, lets go directly with the R simulation\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent <- replicate(100000, {\n    mms <- sample(x = c(\"yellow\", \"red\", \"orange\", \"brown\", \"green\", \"blue\"),\n     size = 30, p = c(0.14, 0.13, 0.20, 0.12, 0.20, 0.21), replace = TRUE)\n    sum(mms == \"blue\") >= 9 & sum(mms == \"orange\") >= 6\n})\nmean(event)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.06431\n```\n:::\n:::\n\n### Problem 2.7\n\n**Blood types O, A, B, and AB have the following distribution in the United States:**\n\n| Type          | A    | AB     | B     | O     | \n|---------------|------|--------|-------|-------|\n| Probability   | 0.40 | 0.04   | 0.11  | 0.45  |\n\n**What is the probability that two randomly selected people have the same blood type?**\n\nSince getting the same blood type is an independent event, we can calculate the probability of getting the same blood type by multiplying the probability of getting each blood type. That is:\n\n$$\nP(\\text{same blood type}) = P(\\text{A})^2 + P(\\text{AB})^2 + P(\\text{B})^2 + P(\\text{O})^2\n$$\n\n$$\nP(\\text{same blood type}) =  0.40^2 + 0.04^2 + 0.11^2 + 0.45^2 = 0.3762\n$$\n\nWe can simulate this experiment in R as follows:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent <- replicate(100000, {\n    person_1 <- sample(x = c(\"A\", \"AB\", \"B\", \"O\"),\n     size = 1, p = c(0.40, 0.04, 0.11, 0.45), replace = TRUE)\n    person_2 <- sample(x = c(\"A\", \"AB\", \"B\", \"O\"),\n     size = 1, p = c(0.40, 0.04, 0.11, 0.45), replace = TRUE)\n\n    person_1 == person_2\n})\nmean(event)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.37586\n```\n:::\n:::\n\n\n### Problem 2.8\n\n**Use simulation to estimate the probability that a 10 is obtained when two dice are rolled.**\n\nBesides the simulation, we can also calculate the probability of getting a 10. The event space is:\n$$\nE = \\{(6,4), (5,5), (4,6)\\}\n$$\n\nAnd the possible outcomes are $6 \\cdot 6 = 36$. Then the probability of getting a 10 is:\n\n$$\nP(\\text{10})  = \\frac{3}{36} = 0.0833\n$$\n\nWe can simulate this in R as follow:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent <- replicate(100000, {\n    dice_1 <- sample(x = 1:6, size = 1, replace = TRUE)\n    dice_2 <- sample(x = 1:6, size = 1, replace = TRUE)\n    dice_1 + dice_2 == 10\n})\nmean(event)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.08374\n```\n:::\n:::\n\n### Problem 2.9\n\n**Estimate the probability that exactly 3 heads are obtained when 7 coins are tossed.**\n\nSince it's a bit long to calculate this one by counting, lets cite and use the definition of the binomial probability\n\n::: {.callout-tip}\nEvents where there are only two possible outcomes that we can classify as success or failure, and where the probability of success is known to us as $p$ are called binomial events. When we repeat such events several times, the probability to find $r$ successes in $n$ such repetitions can be calculated by using the expression:\n\n$$\nP(r) = \\binom{n}{r} p^r (1-p)^{n-r}\n$$\n\nwhere $\\binom{n}{r}$ is the binomial coefficient, which is the number of ways of selecting $r$ objects from a set of $n$ objects,\nwhere the order of selection does not matter.\n:::\n\nKnowing that, we can calculate the probability of getting exactly 3 heads in 7 tosses:\n\n$$\nP(\\text{exactly 3 heads}) = \\binom{7}{3} (0.5)^3 (0.5)^{7-3} = 0.2734375\n$$\n\nWe can simulate this in R as follow:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent <- replicate(100000, {\n    tosses <- sample(x = c(\"H\", \"T\"), size = 7, replace = TRUE)\n    sum(tosses == \"H\") == 3\n})\nmean(event)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.27249\n```\n:::\n:::\n\n\nWe can extend this question by asking what is the probability that at least 3 heads are obtained when 7 coins are tossed.\nTo solve this problem we need to find the probabilities that $r$ could be $3,4,5,6,7$ to satisfy the condition \"at least\".\n\n$$\nP(\\text{at least 3 heads}) = \\sum_{r=3}^{7}  \\binom{7}{r} (0.5)^r (0.5)^{7-r}\n$$\n\n| $r$         | $P(\\text{at least 3 heads})$                 |\n|-------------|----------------------------------------------|\n| for $r = 3$ | $\\binom{7}{3} (0.5)^3 (0.5)^{4} = 0.2734375$ |\n| for $r = 4$ | $\\binom{7}{4} (0.5)^4 (0.5)^{3} = 0.2734375$ |\n| for $r = 5$ | $\\binom{7}{5} (0.5)^5 (0.5)^{2} = 0.1640625$ |\n| for $r = 6$ | $\\binom{7}{6} (0.5)^6 (0.5)^{1} = 0.0546875$ |\n| for $r = 7$ | $\\binom{7}{7} (0.5)^7 (0.5)^{0} = 0.0078125$ |\n\n$$\nP(\\text{at least 3 heads}) = 0.273 + 0.273 + 0.164 + 0.054 + 0.007 = 0.773\n$$\n\nWe could also have calculated this by using the complement of the probability of getting at most 2 heads.\n\n$$\nP(\\text{at least 3 heads}) = 1 - P(\\text{at most 2 heads}) = 1 - \\sum_{r=0}^{2} \\binom{7}{r} (0.5)^r (0.5)^{7-r}\n$$\n\n| $r$         | $P(\\text{at most 2 heads})$                  |\n|-------------|----------------------------------------------|\n| for $r = 0$ | $\\binom{7}{0} (0.5)^0 (0.5)^{7} = 0.0078125$ |\n| for $r = 1$ | $\\binom{7}{1} (0.5)^1 (0.5)^{6} = 0.0546875$ |\n| for $r = 2$ | $\\binom{7}{2} (0.5)^2 (0.5)^{5} = 0.1640625$ |\n\n$$\nP(\\text{at least 3 heads}) = 1 - 0.007 - 0.054 - 0.164 = 0.773\n$$\n\nWe can simulate this in R as follow:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent <- replicate(100000, {\n    tosses <- sample(x = c(\"H\", \"T\"), size = 7, replace = TRUE)\n    sum(tosses == \"H\") >= 3\n})\nmean(event)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.77393\n```\n:::\n:::\n\n### Problem 2.10\n\n**Estimate the probability that the sum of five dice is between 15 and 20, inclusive.**\n\nWe need to count the number of ways that we can roll five dice and get a sum between 15 and 20, and divide that by the total number of possible outcomes when rolling five dice. Since it is a bit long to count all possible combinations of $(a,b,c,d,e)$ where $a+b+c+d+e \\in [15,20]$ We are going directly with the simulation. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent <- replicate(100000, {\n    dice <- sample(x = 1:6, size = 5, replace = TRUE)\n    sum(dice) >= 15 & sum(dice) <= 20\n})\nmean(event)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.55711\n```\n:::\n:::\n\n\n### Problem 2.11\n\n**Suppose a die is tossed repeatedly, and the cumulative sum of all tosses seen is maintained.  Estimate the probability that the cumulative sum ever is exactly 20. (Hint: the function cumsum computes the cumulative sums of a vector.)**\n\nAgain, we are going directly wit the simulation due the overwhelming amount of combinations. We know that 20 is the maximum number of tosses that could have a cumulative sum of 20. So doing a sample of 20 rolls will be enough to get a good estimate.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent <- replicate(100000, {\n    tosses <- sample(x = 1:6, size = 20, replace = TRUE)\n    cumulative_sum <- cumsum(tosses)\n    any(cumulative_sum == 20)\n})\nmean(event)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.28209\n```\n:::\n:::\n\n\n### Problem 2.12\n\n**(Rolling two dice)**\n\na. Simulate rolling two dice and adding their values. Perform 10,000 simulations and make a bar chart showing how many of each outcome occurred.\n\nb. You can buy trick dice, which look (sort of) like normal dice. One die has numbers 5, 5, 5, 5, 5, 5. The other has numbers 2, 2, 2, 6, 6, 6. Simulate rolling the two trick dice and adding their values. Perform 10,000 simulations and make a bar chart showing how many of each outcome occurred.\n\nc. Sicherman dice also look like normal dice, but have unusual numbers. One die has numbers 1, 2, 2, 3, 3, 4. The other has numbers 1, 3, 4, 5, 6, 8. Simulate rolling the two Sicherman dice and adding their values. Perform 10,000 simulations and make a bar chart showing how many of each outcome occurred. How does your answer compare to part (a)?\n\n\n#### Part (a)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\noutcomes <- replicate(10000, {\n    dice_1 <- sample(x = 1:6, size = 1, replace = TRUE)\n    dice_2 <- sample(x = 1:6, size = 1, replace = TRUE)\n    dice_1 + dice_2\n})\ndf <- data.frame(outcomes)\nggplot(data = df, mapping = aes(outcomes), fill = \"transparent\") +\ngeom_histogram(bins = 11, fill = \"transparent\", color = \"black\")\n```\n\n::: {.cell-output-display}\n![](probability_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n#### Part (b)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\noutcomes <- replicate(10000, {\n    dice_1 <- sample(x = c(5, 5, 5, 5, 5, 5), size = 1, replace = TRUE)\n    dice_2 <- sample(x = c(2, 2, 2, 6, 6, 6), size = 1, replace = TRUE)\n    dice_1 + dice_2\n})\ndf <- data.frame(outcomes)\nggplot(data = df, mapping = aes(outcomes), fill = \"transparent\") +\ngeom_histogram(bins = 11, fill = \"transparent\", color = \"black\")\n```\n\n::: {.cell-output-display}\n![](probability_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n#### Part (c)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\noutcomes <- replicate(10000, {\n    dice_1 <- sample(x = c(1, 2, 2, 3, 3, 4), size = 1, replace = TRUE)\n    dice_2 <- sample(x = c(1, 3, 4, 5, 6, 8), size = 1, replace = TRUE)\n    dice_1 + dice_2\n})\ndf <- data.frame(outcomes)\nggplot(data = df, mapping = aes(outcomes), fill = \"transparent\") +\ngeom_histogram(bins = 11, fill = \"transparent\", color = \"black\")\n```\n\n::: {.cell-output-display}\n![](probability_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\nThey have the same distribution.\n\n### Problem 2.13\n\n**In a room of 200 people (including you), estimate the probability that at least one other person will be born on the same day as you.**\n\nwe can use the complement rule and calculate the probability that none of the other 199 people share the same birthday as me. Assuming that birthdays are uniformly distributed across all 365 days of the year (ignoring leap years), the probability that any given person in the room was not born on the same day as me is:\n\n$$\nE = \\text{No one else has the same birthday as you}\n$$\n\n$$\nP(E) = \\left(\\frac{1}{365}\\right)^{199} = 0.58\n$$\n\nAnd the probability that at least one other person has the same birthday as you is:\n\n$$\nF = \\text{At least one other person has the same birthday}\n$$\n\n$$ \nP(F) = 1 - P(E) = 0.42\n$$\n\nwe can simulate this in R as follow:\n\n::: {.cell}\n\n```{.r .cell-code}\nevent <- replicate(100000, {\n    my_birthday <- sample(x = 1:365, size = 1, replace = TRUE)\n    other_people_birthdays <- sample(x = 1:365, size = 199, replace = TRUE)\n    any(other_people_birthdays == my_birthday)\n})\nmean(event)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.42159\n```\n:::\n:::\n\n\n### Problem 2.14\n\n**In a room of 100 people, estimate the probability that at least two people were not only born on the same day,\nbut also during the same hour of the same day. (For example, both were born between 2 and 3.)**\n\nAssuming each person birth is uniformly distributed across all 24 hours of the day, and all 365 days of the year (ignoring leap years). The probability that any two people were born during the same hour of the same day is:\n\n$$\nE = \\text{Two people were born during the same hour of the same day}\n$$\n\n$$\nP(E) = \\frac{1}{24} \\cdot \\frac{1}{365} = 0.0001\n$$\n\nThen the probability that none of the 100 people were born on the same day and during the same hour can be expressed as:\n\n$$\nF = \\text{None of the 100 people were born on the same day and during the same hour}\n$$\n\n$$\nP(F) = \\left(1 - P(E)\\right)^{\\binom{100}{2}} = 0.5683\n$$\n\nfinally the probability that at least two people were born during the same hour of the same day is:\n\n$$\nG = \\text{At least two people were born during the same hour of the same day}\n$$\n\n$$\nP(G) = 1 - P(F) = 0.4316\n$$\n\nWe can simulate this in R as follow:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent <- replicate(100000, {\n    birthdays <- sample(x = 1:(365 * 24), size = 100, replace = TRUE)\n    sum(duplicated(birthdays)) >= 1\n})\nmean(event)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.43076\n```\n:::\n:::\n\n\n### Problem 2.15\n\n**Assuming that there are no leap-day babies and that all birthdays are equally likely, estimate the probability that at least three people have the same birthday in a group of 50 people. (Hint: try using table.)**\n\nThe probability of the birthday problem becomes increasingly complicated with more people, as the complementary event includes a larger number of possibilities that need to be accounted for. For example, for three people, the complementary event not only includes the possibility that all three birthdays are distinct, but also the possibilities of having one pair with the rest distinct, two pairs with the rest distinct, and so on. Calculating the exact value can be quite complicated.\n\n::: {.callout-warning}\nI'm going to use the Poisson approximation to calculate the probability of the birthday problem. The Poisson approximation is a good approximation for large values of $n$ and small values of $p$. In this case, $n = 50$ and $p = \\frac{1}{365}$. However, the autor maybe want us to only simulate the problem, because at this chapter we are not supposed to know the Poisson approximation.\n:::\n\nOne way to approach this is by considering every group of three people and calling it a \"success\" if they all share the same birthday.\nThis can be modeled as a Poisson distribution, where the expected number of \"successes\" is the number of groups of three people times the probability that three people share the same birthday.\n\nThe total number of successes is approximately Poisson with mean value $\\frac{\\binom{50}{3}}{365^{2}}$.\nHere $\\binom{50}{3}$ is the number of triples, and $\\frac{1}{365^{2}}$ is the chance that any particular triple is a success.\nThe probability of getting at least one success is obtained from the Poisson distribution:\n\n$$\nP(\\text{at least one tripe birthday with 50 people}) \\approx 1 - \\exp \\left(- \\frac{\\binom{50}{3}}{365^{2}}\\right) = 0.1368092\n$$\n\nWe can simulate this in R as follow:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent <- replicate(100000, {\n    birthdays <- sample(x = 1:365, size = 50, replace = TRUE)\n    birthday_table <- table(birthdays)\n    length(birthday_table[birthday_table >= 3])\n})\nmean(event)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1337\n```\n:::\n:::\n\n\n### Problem 2.16\n**If 100 balls are randomly placed into 20 urns, estimate the probability that at least one of the urns is empty.**\n\nThe probability of choose an specific urn is $\\frac{1}{20}$ then the probability of not choose an specific urn is $\\frac{19}{20}$\nand the probability of not choose an specific urn 100 times is $\\left(\\frac{19}{20}\\right)^{100}$. To get the probability of at least one urn is empty we need to multiply this by the number of urns:\n\n$$\nP(E) = \\left(\\frac{19}{20}\\right)^{100} \\cdot 20 = 0.1184\n$$\n\nWe can simulate this in  R as follow:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nevent  <- replicate(100000, {\n    selected_urns <- sample(x =  1:20, size = 100, replace = TRUE)\n    length(unique(selected_urns)) < 20\n})\nmean(event)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.11279\n```\n:::\n:::\n\n\n### Problem 2.17\n**A standard deck of cards has 52 cards, four each of 2,3,4,5,6,7,8,9,10,J,Q,K,A. In blackjack, a player gets two cards and adds their values. Cards count as their usual numbers, except Aces are 11 (or 1), while K, Q, J are all 10.**\n\na. “Blackjack” means getting an Ace and a value 10 card. What is the probability of getting a blackjack?\nb. What is the probability of getting 19? (The probability that the sum of your cards is 19, using Ace as 11)\n\n#### Part (a)\n\nWe can see it as follow:\n\n1) We're dealt an 11, and then a 10. (11 + 10 = 21)\n2) We're dealt a 10, and then an 11. (10 + 11 = 21)\n\n* Option 1:\n\nFirst event (getting an 11 card): There are 4 aces in a pack, and we've got a full pack (52 cards), so the probability of getting one of the aces first is 4 out of 52 $\\frac{4}{52}$. Second event (getting a 10 card): There are 16 cards worth 10 in a pack (4 of each of 10, J, Q, K), but we've already got one of the cards from the back, so the probability of getting a 10 now is 16 out of 51 $\\frac{16}{51}$. We want event 1 AND event 2 to happen, so we have to multiply the probabilities: $\\frac{4}{52} \\cdot \\frac{16}{51} = \\frac{64}{2652}$\n\n* Option 2:\n\nFirst event (getting a 10 card): There are 16 cards worth 10, as before, but this time we've got a full pack, so the probability is $\\frac{16}{52}$. Second event (getting an 11 card): There are 4 aces, as before, but this time we've got rid of one card, so the probability is $\\frac{4}{51}$. Again, we want event 1 AND event 2 to happen: $\\frac{4}{51} \\cdot \\frac{16}{52} = \\frac{64}{2652}$\n \nNow, we want either option 1 OR option 2to happen (because either way will give us a blackjack). \nThere's an OR there, so we've got to add the two probabilities together: \n\n$$\nP(\\text{getting a blackjack}) = \\frac{64}{2652} + \\frac{64}{2652} = \\frac{128}{2652} = 0.048\n$$\n\nWe can simulate this in R as follow:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndeck <- c(\"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"10\", \"10\", \"10\", \"A\")\nevent  <- replicate(100000, {\n    cards <- sample(x = deck, size = 2, replace = TRUE)\n    (cards[1] == \"A\" && cards[2] == \"10\") ||\n    (cards[1] == \"10\" && cards[2] == \"A\")\n})\nmean(event)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.0472\n```\n:::\n:::\n\n\n#### Part (b)\n\nWe can see it as follow:\n\n1) We're dealt an 11, and then a 8. (11 + 8 = 19)\n2) We're dealt a 8, and then an 11. (11 + 8 = 19)\n3) We're dealt an 10 and a 9. (10 + 9 = 19)\n4) We're dealt a 9 and a 10. (9 + 10 = 19)\n\nSo we can calculate the probability similarly as the previous problem:\n\n$$\nP(\\text{getting 19}) = 2 \\cdot \\frac{4}{52} \\cdot \\frac{4}{51} + 2 \\cdot \\frac{16}{52} \\cdot \\frac{4}{51} = 0.60\n$$\n\nWe can simulate this in R as follow:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndeck <- c(\"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"10\", \"10\", \"10\", \"A\")\nevent  <- replicate(100000, {\n    cards <- sample(x = deck, size = 2, replace = TRUE)\n    (cards[1] == \"9\" && cards[2] == \"10\") ||\n    (cards[1] == \"10\" && cards[2] == \"9\") ||\n    (cards[1] == \"A\" && cards[2] == \"8\")  ||\n    (cards[1] == \"8\" && cards[2] == \"A\")\n})\nmean(event)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.05917\n```\n:::\n:::\n",
    "supporting": [
      "probability_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}